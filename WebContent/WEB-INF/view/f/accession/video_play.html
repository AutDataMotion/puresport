<!DOCTYPE HTML>
<html>
<head>
<title>准入学习</title>
<link rel="shortcut icon" href="${cxt!}/images/favicon.ico" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords"
	content="Skate Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />
<script type="application/x-javascript">
	
	 addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } 

</script>

<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="0">

<!-- Bootstrap -->
<link href="${cxt!}/css/style.css" rel="stylesheet" type="text/css"
	media="all" />
<!-- start plugins -->
<script type="text/javascript" src="${cxt!}/js/puresport.js"></script>
<script type="text/javascript" src="${cxt!}/js/jquery-1.11.1.min.js"></script>
<link href="${cxt!}/ui/bootstrap-3.3.7-dist/css/bootstrap.min.css"
	rel='stylesheet' type='text/css' />
<script type="text/javascript"
	src="${cxt!}/ui/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
<!-- start slider -->
<link rel="stylesheet" href="${cxt!}/css/fwslider.css" media="all">
<script src="${cxt!}/js/fwslider.js"></script>
<!-- end slider -->
<!-- must have -->
<link href="${cxt!}/css/allinone_carousel.css" rel="stylesheet"
type="text/css">
<script src="${cxt!}/js/jquery-ui-1.8.16.custom.min.js"
type="text/javascript"></script>
<script src="${cxt!}/js/allinone_carousel.js" type="text/javascript"></script>
<!-- 视频播放控件 start -->
<link rel="stylesheet" href="/css_zhuchaobin/video-js.css">
<script type="text/javascript">		
	/* 	function do_next(){
			var x = document.getElementById("my-video").ended;//检测视频是否播放结束true,否则返回false
			var stdy_st = document.getElementById("stdy_st_hidden").value;

			// 视频学习完成或者已经学习本课程的学习
			if(x || ("1" == stdy_st)){
					if(x){
						recordCourse(1);// 记录课程学习记录
					}
					window.location.href='${action!}';// 进行下一步学习
				} else {
				 $('#tip1Modal').modal('show');				
			}
		} */
		
		// 记录用户学习结果
		function recordCourse() {
			alert(test);
			var url;
			url = '/jf/puresport/t5CrclStdy/update';
			var crclid = document.getElementById("crclid").value;
			$.ajax({
				type : 'POST',
				url : url,
				dataType : "json",
				traditional : true,
				data : {
					"userid" : ${session["usrid"]},"crclid":crclid
				},
				success : function(res) {
					if (res.code == "0000") {
						return true;
					} else {
						return false;
					}
				},
				dataType : "json"
			});
		}
		
		var isFinishPlay = false;		
		function do_next(){
			var stdy_st = document.getElementById("stdy_st_hidden").value;
			// 视频学习完成或者已经学习本课程的学习
			if(isFinishPlay || ("1" == stdy_st)){
			/* 	alert(isFinishPlay); */
					if(isFinishPlay){
			/* 			alert(isFinishPlay); */
						/* recordCourse();// 记录课程学习记录 */
						{
							var url;
							url = '/jf/puresport/t5CrclStdy/update';
							var crclid = document.getElementById("crclid").value;
						/* 	alert(); */
							$.ajax({
								type : 'POST',
								url : url,
								dataType : "json",
								traditional : true,
								data : {
									"userid" : ${session["usrid"]},"crclid":crclid
								},
								success : function(res) {
									if (res.code == "0000") {
										return true;
									} else {
										return false;
									}
								},
								dataType : "json"
							});														
						}
					}
					window.location.href='${action!}';// 进行下一步学习
				} else {
				 $('#tip1Modal').modal('show');				
			}
		}
		//  返回上一页面
		function do_pre(){
/* 			window.location.href=document.referrer; */
			window.location.href='${pre_action!}';
		}	
		
			
	</script>
</head>
<body>
	<style type="text/css">
.title {
	text-indent: 2em; /* 段首缩进2个字符  */
	font-family: "微软雅黑", "黑体", "宋体";
	font-size: 18px;
}
</style>
	<% include("/f/header.html"){} %>
	<div class="main_bg">
<!-- 		start main -->
		<div class="container">
			<div class="main_grid1">
				<h3 class="style pull-left">学习</h3>
				<h3 class="style pull-right">${session['which_competition']}</h3>
			</div>
		</div>
	</div>
	<!-- start main_btm -->
	<div class="main_btm1">
		<!-- 	start main_btm -->
		<div class="container">
			<div class="row">
				<div class="row">
					<div class="col-md-2 span1_of_2"></div>
					<div class="col-md-8 span1_of_8">
						<div class="span4_of_list" width="65%">
							<div align="center">
								<p class="res_pic_title" style="text-align: center;">
									<h3>${crcl_nm!"反兴奋剂准入系统操作流程"}</h3>
								</p>
							</div>
							<div align="center">
								<!--<video id="my-video"  width="100%" height="100%"
									controls="controls" autoplay="autoplay" preload="auto">
									<source src="${crcl_file_rte!''}" type="video/mp4" />
								</video> -->
								<div id="myflashBox" style="min-height: 40em;"></div>
							</div>
						</div>
					</div>
				</div>
				<p>
					<div align="center">
						<button onclick="do_pre()" class="btn">上一步</button>
						<button onclick="do_next()" class="btn">下一步</button>
					</div>
			</div>
			</br>
		</div>
		<!-- tip1 Modal -->
		<div class="modal fade" id="tip1Modal" tabindex="-1" role="dialog"
			aria-labelledby="tip1ModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header" align="center">
						<h4 class="modal-title">友情提示</h4>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body" align="center">对不起！视频播放完毕才能进行下一步学习，请耐心等待！</div>
					<div class="modal-footer" align="center">
						<button type="button" class="btn" data-dismiss="modal">确定</button>
					</div>
				</div>
				<!-- 	/.modal-content -->
			</div>
			<!-- /.modal-dialog -->
		</div>
		<input type="hidden" id="stdy_st_hidden" value="${stdy_st_hidden!'0'}">
		</input> <input type="hidden" id="crclid" value="${crclid!'-1'}">
	</div>

	</input> <% include("/f/footer.html"){} %>

</body>
<!-- 新浪播放器 -->
<script>
	window.$FlashConfig = {
		url: "",				// flash播放器地址,
    container : "myflashBox",	// 播放器初始化容器节点
    id: "myMovie",						// 播放器id
		width: '100%',								// 播放器宽度
		height: '100%',							// 播放器高度
		// flash播放器参数
		params : {
		 allowNetworking : "all",
		 allowScriptAccess : "always",
		 wmode : "opaque",
		 allowFullScreen : "true",
		 quality : "high"
		},
		attributes: {},
		flashvars: {
			autoPlay: 1,  				// 是否自动播放
			loop: 0,							// 是否循环播放
			autoLoad: 1,					// 是否自动加载资源
			thumbUrl: '',					// 封面图
			tj: 1,								// 是否出现播后推荐
			as: 1									// 是否前贴片广告
		},
		h5attr: {
			autoPlay: false,  		// 是否自动播放
			controls: true, 			// 是否显示控制条
			loop: false,					// 是否循环播
			poster: '', 					// 封面图
			preload: 'auto' 			// 是否预先加载资源
		}
	};	
	var $SCOPE = {}
	$SCOPE['video'] = {
		video_id:'${crcl_file_rte!''}',
    pid:'1',
    url: window.location.href,
    title:'${crcl_nm!}',
		swfOutsideUrl: ''
  };
	var videos = [
		{
			video_id: ${crcl_file_rte!''},
			pid:'1',
			url: window.location.href,
			title:'${crcl_nm!''}'
		}
	]
</script>
<script src="http://sjs2.sinajs.cn/video/sinaplayer/js/page/player.js"></script>
<script>
var player = playVideo($FlashConfig);
player.init($SCOPE.video);
var num = 0;
player.on("playCompleted", function(){
	isFinishPlay = true;
	player.playVideo(videos[num++]);
});

player.on("h5RecordeValue", function(data, palyerid){
	//console.log(data, palyerid);
});
player.on("flashInitCompleted", function(data){
	console.log("fffFF");
});
</script>
</html>